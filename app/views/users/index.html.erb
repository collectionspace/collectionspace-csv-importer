<h1 class="title"><%= t('user.title') %></h1>

<table class="table is-fullwidth is-hoverable">
  <thead>
    <tr>
      <th><%= t 'user.email' %></th>
      <th><%= t 'user.group' %></th>
      <th><%= t 'user.role' %></th>
      <th><%= t 'user.enabled' %></th>
      <% if admin? %>
        <th colspan="1"></th>
      <% end %>
    </tr>
  </thead>

  <tbody>
    <% policy_scope(@users).each do |user| %>
      <tr>
        <td class='pt-3'>
          <% if manage?(user) %>
            <%= link_to edit_user_path(user) do %>
              <%= render partial: 'user', locals: { icon: 'pencil', user: user } %>
            <% end %>
          <% else %>
            <%= render partial: 'user', locals: { icon: 'user', user: user } %>
          <% end %>
        </td>
        <td class='pt-3'><%= user.group.name %></td>
        <td class='pt-3'><%= user.role.name %></td>
        <td class='pt-3'>
          <% if user.enabled? %>
            <%= render partial: 'shared/icon',
                locals: { classes: 'has-text-success', icon: 'check-square' }
            %>
          <% else %>
            <%= render partial: 'shared/icon',
                locals: { classes: 'has-text-danger', icon: 'ban' }
            %>
          <% end %>
        </td>
        <% if admin? %>
          <td>
            <%=
              link_to t('navigation.delete'), user,
              method: :delete, data: { confirm: t('action.confirm_delete') },
              class: 'button is-danger is-outlined is-small'
            %>
          </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
